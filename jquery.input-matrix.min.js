(function(a){function b(){var b=a("<input/>",{"class":"di_remove_row",type:"button",value:"-"});return b}function c(){var b=a("<input/>",{"class":"di_add_row",type:"button",value:"+"});return b}var d={init:function(b){var c={rows:1,cols:2,name:"input_matrix",autocomplete:false,values:[],onRowAdd:function(a){},onRowDelete:function(a){}};if(b){a.extend(c,b)}return this.each(function(){var b=a(this),d=b.data("inputMatrix"),e=a("<table/>");b.find("input.di_remove_row").live("click",function(){var c=a(this).parent().parent();b.inputMatrix("deleteRow",c.data("row_num"))});b.find("input.di_add_row").live("click",function(){var c=a(this).parent().parent();b.inputMatrix("addRow",c.data("row_num"))});if(!d){a(this).data("input_matrix",{target:b,input_matrix:e,settings:c})}for(var f=0;f<c.rows;f++){a(this).inputMatrix("addRow",f,true)}b.html(e)})},addRow:function(d,e){return this.each(function(){var f=a(this),g=f.data("input_matrix"),h=g.settings,i=a("<tr/>");i.attr("row",d);for(var j=0;j<h.cols;j++){var k="";if(h.values[d]&&h.values[d][j]){k=h.values[d][j]}var l=a("<td/>"),m=a("<input/>",{type:"text",name:h.name+"_"+(d+1)+"_"+(j+1),value:e?k:"",autocomplete:h.autocomplete?"yes":"no"});l.html(m);i.append(l)}var l=a("<td/>",{"class":"row_action_1"});if(d>0){l.html(b());i.append(l);var l=a("<td/>",{"class":"row_action_2"});l.html(c());i.append(l)}else{l.html(c());i.append(l);var l=a("<td/>",{"class":"row_action_2"});i.append(l)}if(d>0){g.input_matrix.find('tr[row="'+d+'"]').after(i)}else{g.input_matrix.append(i)}g.input_matrix.find("tr").each(function(b){a(this).data("row_num",b+1);a(this).attr("row",b+1);a(this).find('input[type="text"]').each(function(c){a(this).attr("name",h.name+"_"+(b+1)+"_"+(c+1))})});if(!e){h.onRowAdd(d+1)}if(g.input_matrix.find("tr").length>1){g.input_matrix.find('tr[row="1"] .row_action_1').html(b());g.input_matrix.find('tr[row="1"] .row_action_2').html(c())}else{g.input_matrix.find('tr[row="1"] .row_action_1').html(c());g.input_matrix.find('tr[row="1"] .row_action_2').html("")}})},deleteRow:function(d){return this.each(function(){var e=a(this),f=e.data("input_matrix"),g=f.settings;f.input_matrix.find('tr[row="'+d+'"]').remove();f.input_matrix.find("tr").each(function(b){a(this).data("row_num",b+1);a(this).attr("row",b+1);a(this).find('input[type="text"]').each(function(c){a(this).attr("name",g.name+"_"+(b+1)+"_"+(c+1))})});if(f.input_matrix.find("tr").length>1){f.input_matrix.find('tr[row="1"] .row_action_1').html(b());f.input_matrix.find('tr[row="1"] .row_action_2').html(c())}else{f.input_matrix.find('tr[row="1"] .row_action_1').html(c());f.input_matrix.find('tr[row="1"] .row_action_2').html("")}g.onRowDelete(d)})},destroy:function(){return this.each(function(){var b=a(this),c=b.data("input_matrix");a(window).unbind(".input_matrix");c.input_matrix.remove();b.removeData("input_matrix")})},setValue:function(b,c,d){return this.each(function(){var e=a(this),f=e.data("input_matrix").settings;e.find('input[name="'+f.name+"_"+b+"_"+c+'"]').val(d)})},getValue:function(b,c){var d;this.each(function(){var e=a(this),f=e.data("input_matrix").settings;d=e.find('input[name="'+f.name+"_"+b+"_"+c+'"]').val()});return d},getMatrixData:function(){var b=[];this.each(function(){var c=a(this),d=c.data("input_matrix");d.input_matrix.find("tr").each(function(c){var d=[];a(this).find('input[type="text"]').each(function(b){d.push(a(this).val())});b.push(d)})});return b},getRowData:function(b){var c=[];this.each(function(){var d=a(this),e=d.data("input_matrix");e.input_matrix.find("tr").each(function(d){if(a(this).data("row_num")==b){a(this).find('input[type="text"]').each(function(b){c.push(a(this).val())})}})});return c}};a.fn.inputMatrix=function(b){if(d[b]){return d[b].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof b==="object"||!b){return d.init.apply(this,arguments)}else{a.error("Method "+b+" does not exist on jQuery.inputMatrix")}}})(jQuery)